FROM laristra/flecsi-third-party:fedora

ARG MINIMAL
ARG LEGION
ARG RUNTIME
ARG COVERAGE
ARG SONARQUBE
ARG SONARQUBE_TOKEN
ARG SONARQUBE_GITHUB_TOKEN
ARG CC
ARG CXX
ARG CXXFLAGS

#for coverage
ARG CI
ARG TRAVIS
ARG TRAVIS_BRANCH
ARG TRAVIS_JOB_NUMBER
ARG TRAVIS_PULL_REQUEST
ARG TRAVIS_JOB_ID
ARG TRAVIS_TAG
ARG TRAVIS_REPO_SLUG
ARG TRAVIS_COMMIT
ARG TRAVIS_OS_NAME
ARG IGNORE_NOCI

ARG CI_COMMIT_REF_NAME
ARG CI_JOB_ID
ARG CI_REPOSITORY_URL
ARG CI_COMMIT_SHA

COPY flecsi /home/flecsi/flecsi
USER root
RUN chown -R flecsi:flecsi /home/flecsi/flecsi
USER flecsi

RUN pwd
RUN ls -la
WORKDIR /home/flecsi/flecsi
RUN ls -la
#RUN cp /home/flecsi/build /home/flecsi/flecsi/

WORKDIR build
RUN pwd
RUN ls -la
USER root
RUN make install
USER flecsi
WORKDIR /home/flecsi
